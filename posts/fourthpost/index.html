<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wikipedia&#39;s API, and Using &#39;wikipedia-query&#39; to Fetch Articles</title>
    <meta name="description" content="This is a post on getting started with the Wikipedia API.">
    <link rel="stylesheet" href="/eleventy-template-blog/css/index.css">
    <link rel="stylesheet" href="/eleventy-template-blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/eleventy-template-blog/feed/feed.xml" type="application/atom+xml" title="Erik&#39;s Blog">
    <link rel="alternate" href="/eleventy-template-blog/feed/feed.json" type="application/json" title="Erik&#39;s Blog">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/eleventy-template-blog/">Erik&#39;s Blog</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/eleventy-template-blog/">Home</a></li>
        <li class="nav-item"><a href="/eleventy-template-blog/posts/">Archive</a></li>
        <li class="nav-item"><a href="/eleventy-template-blog/about/">About Me</a></li>
      </ul>
    </header>

    <main class="tmpl-post">

      <!--
      <div class="warning">
        <ol>
          <li>Edit the <code>_data/metadata.json</code> with your blogâ€™s information.</li>
          <li>(Optional) Edit <code>.eleventy.js</code> with your <a href="https://www.11ty.dev/docs/config/">configuration preferences</a>.</li>
          <li>Delete this message from <code>_includes/layouts/base.njk</code>.</li>
        </ol>
        <p><em>This is an <a href="https://www.11ty.dev/">Eleventy project</a> created from the <a href="https://github.com/11ty/eleventy-base-blog"><code>eleventy-base-blog</code> repo</a>.</em></p>
      </div>
      -->

      <h1>Wikipedia&#39;s API, and Using &#39;wikipedia-query&#39; to Fetch Articles</h1>

<time datetime="2022-02-24">24 Feb 2022</time><a href="/eleventy-template-blog/tags/wikipedia/" class="post-tag">wikipedia</a>

<p>Let's say you want to display information about a company, city, or your favorite food on your website. Of course you could just write it out yourself, but what if something changes or gets updated with better information? You can use Wikipedia's API to find an article from their website using regular search terms. In this blog, we will find out how to do this, but first we will talk about the <code>fetch()</code> JavaScript function. I will use my project <a href="https://github.com/erikgraybill/ip-project">here</a> as an example.</p>
<p><code>fetch()</code> is an asynchronous function, meaning it can execute as other code is running at the same time; it will return whatever data is gathered whenever it can and the rest of the code continues on. It is used for HTTP requests and responses. You can learn more about the function <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">here</a>. In my example, the fetch function is used to return a JSON response with information about the user's location from <a href="https://freegeoip.app/json/">https://freegeoip.app/json/</a>. Once the function receives the information, it returns it and the code within <code>.then</code> executes.<br>
<em>Example JSON retrieved from fetch()</em></p>
<pre><code>{
&quot;ip&quot;: &quot;192.0.2.1&quot;,
&quot;country_code&quot;: &quot;US&quot;,
&quot;country_name&quot;: &quot;United States&quot;,
&quot;region_code&quot;: &quot;PA&quot;,
&quot;region_name&quot;: &quot;Pennsylvania&quot;,
&quot;city&quot;: &quot;State College&quot;,
&quot;zip_code&quot;: &quot;16803&quot;,
&quot;time_zone&quot;: &quot;America/New_York&quot;,
&quot;latitude&quot;: 40,
&quot;longitude&quot;: -77,
&quot;metro_code&quot;: 574
}
</code></pre>
<p>From here, my code takes the information from the JSON response and stores it for later use in the Wikipedia query, as seen in this screenshot. <em>I specifically use city and state for the query.</em><br>
<img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/dn4bw5lff4kl6rxnhxm9.png" alt="Image description"></p>
<h2 id="mediawiki-api" tabindex="-1">MediaWiki API <a class="direct-link" href="#mediawiki-api" aria-hidden="true">#</a></h2>
<p>We will begin with looking at the API itself. This API can perform many different actions and be utilized in very specified ways dependent on the use case, but we will focus on the action, origin, and format parameters here. Full documentation of the API can be found <a href="https://en.wikipedia.org/w/api.php">here</a>.</p>
<ul>
<li><strong>origin</strong> sets the originating domain of the information being queried. In my instance, this is set to '*' to signify a non-authenticated request which still works, but some user-specific functions are disabled.</li>
<li><strong>action</strong> specifies which action is to be performed. In our case, we will set this to 'query'.</li>
<li><strong>format</strong> is self explanatory, and specifies what format the information will be returned as. In my case, it is set to return JSON.</li>
</ul>
<p>When performing <code>action=query</code>, some more parameters can be specified. In my case, I use <strong>prop</strong> and set it to 'extracts' in order to get the plain text of the given page being fetched, as well as <strong>titles</strong> which specifies what the title of the page to be returned. This is set to be the term being queried in <code>wikipedia-query</code>.</p>
<h2 id="wikipedia-query" tabindex="-1">wikipedia-query <a class="direct-link" href="#wikipedia-query" aria-hidden="true">#</a></h2>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/na9lsrk4gy8ff6hj8tbz.png" alt="Image description"> Now it's time to implement the MediaWiki API. The code pictured above is the block within the <code>wikipedia-query</code> tag that uses the MediaWiki API. It uses <code>fetch()</code> to send a query via the API, and the query has the titles parameter set to a variable. I use three <code>wikipedia-query</code> tags to display the city and state, just the city, and just the state of the user using the data that was stored earlier from <a href="https://freegeoip.app/json/">https://freegeoip.app/json/</a>. In the picture below, you can see how the search term is constructed in my code.<br>
<img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/yrfflah5q1fhpxksvhbr.png" alt="Image description"> So, in this example, three queries are sent to the MediaWiki API: one with title set to State College, Pennsylvania, one set to State College, and one set to Pennsylvania. The following picture shows a portion of what is returned from the MediaWiki API, what isn't shown is just the rest of the article.<br>
<img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/59j14w9imh9jtjs780x4.png" alt="Image description"><br>
<em>You can see the that 'title' is the search term, and extract is the HTML version of the Wikipedia article for State College, Pennsylvania. The page id is also given.</em></p>
<p>In summary, my example fetches a JSON response with the user's location information and stores it. The <code>wikipedia-query</code> tag invokes the MediaWiki API, takes the search term (in my case, city and state, city, and state in three separate queries), and sets the API 'titles' parameter to that term. The MediaWiki API then sends the query and retrieves the Wikipedia article for the given title (aka search term) in JSON format.</p>

<hr>
<ul><li>Next: <a href="/eleventy-template-blog/posts/thirdpost/">An Introduction to Open Web Components</a></li><li>Previous: <a href="/eleventy-template-blog/posts/secondpost/">This is my second post.</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /eleventy-template-blog/posts/fourthpost/ -->
  </body>
</html>
